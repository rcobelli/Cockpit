<!DOCTYPE html>
<html>

<head>
  <title>Safari Push Notification</title>
  <!-- PushAlert -->
  <script type="text/javascript">
    (function(d, t) {
            var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
            g.src = "https://cdn.pushalert.co/integrate_a4861a4c54150ccac2763546be15a675.js";
            s.parentNode.insertBefore(g, s);
    }(document, "script"));
  </script>
  <!-- End PushAlert -->
</head>

<body>
  <button id="allow_push">Allow Push</button>
  <script>
    var p = document.getElementById("allow_push");
    p.onclick = function (e) {
      e.preventDefault();
      // Ensure that the user can receive Safari Push Notifications.
      if ('safari' in window && 'pushNotification' in window.safari) {
        var permissionData = window.safari.pushNotification.permission('web.com.rybel-llc.cockpit');
        checkRemotePermission(permissionData);
      }
    };

    var checkRemotePermission = function (permissionData) {
      if (permissionData.permission === 'default') {
        // This is a new web service URL and its validity is unknown.
        window.safari.pushNotification.requestPermission(
          'https://dev.rybel-llc.com:451', // The web service URL.
          'web.com.rybel-llc.ccockpit', // The Website Push ID.
          {}, // Data that you choose to send to your server to help you identify the user.
          checkRemotePermission // The callback function.
        );
      } else if (permissionData.permission === 'denied') {
        console.log('The user said no.');
      } else if (permissionData.permission === 'granted') {
        console.log("The user said yes, with token: " + permissionData.deviceToken);
      }
    };
  </script>
</body>

</html>